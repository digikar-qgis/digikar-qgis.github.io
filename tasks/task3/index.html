<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="J. Chazalon; E. Carlinet; Y. Chen; J. Perret; C. Mallet; B. Duménieu; T. Géraud">
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Task 3: Locate Graticule Lines Intersections - ICDAR 2021 Competition on Historical Map Segmentation</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../css/theme.css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Task 3: Locate Graticule Lines Intersections";
    var mkdocs_page_input_path = "tasks/task3.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> ICDAR 2021 Competition on Historical Map Segmentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../..">Overview</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Tasks</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../task1/">Task 1: Detect Building Blocks</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../task2/">Task 2: Segment Map Content Area</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Task 3: Locate Graticule Lines Intersections</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#input">Input</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#ground-truth-and-expected-outputs">Ground truth and Expected outputs</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#dataset">Dataset</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#file-naming-conventions">File naming conventions</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#number-of-elements-per-set">Number of elements per set</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#csv-file-format">CSV file format</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#evaluation">Evaluation</a>
    </li>
    </ul>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Participate</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../downloads/">Downloads</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../registration/">Registration</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../rules/">Competition Rules</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">More information</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../contact/">Contact</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">ICDAR 2021 Competition on Historical Map Segmentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Tasks &raquo;</li>
        
      
    
    <li>Task 3: Locate Graticule Lines Intersections</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/icdar21-mapseg/icdar21-mapseg.github.io/edit/main/docs/tasks/task3.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"
    integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X"
    crossorigin="anonymous" />

<style type="text/css">
    .katex img {
      display: block;
      position: absolute;
      width: 100%;
      height: inherit;
    }
</style>
<h1 id="task-3-locate-graticule-lines-intersections">Task 3: Locate Graticule Lines Intersections</h1>
<p>This task consists in locating the intersection points of graticule lines.</p>
<p>Graticule lines are lines indicating the North/South/East/West major coordinates in the map.
They are drawn every 1000 meters in each direction and overlap with the rest of the map content.
Their intersections are very useful to geo-reference the map image, ie for projecting map content in a modern <a href="https://docs.qgis.org/3.16/en/docs/gentle_gis_introduction/coordinate_reference_systems.html">geographical coordinate reference system</a>.</p>
<p>Given the image of a complete map sheet, you need to locate the intersection points of such lines, as illustrated below.
<center>
<img alt="Illustration of expected outputs for task 3" src="../../img/task3-output_illustration-large.jpg" />
<em>Illustration of expected outputs for task 3: dashed green lines are the graticule lines and red dots are the intersections points to locate.</em>
</center></p>
<p>We identified the following challenges:</p>
<ol>
<li>Theses lines, while crossing the map from edge to edge, may not be horizontal and vertical but sometimes diagonal.</li>
<li>They can be damaged and locally curbed.</li>
<li>They overlap numerous map content and can touch other parallel segments.</li>
</ol>
<h2 id="input">Input</h2>
<p><strong>Note that the inputs for this task are the same as task 2.</strong></p>
<p>The inputs form a set of JPEG RGB images like the one illustrated below.
There are complete map sheet images.
Those images can be large (10000x10000 pixels).</p>
<p><center>
<img alt="Sample input for task 3" src="../../img/task23-input-large.jpg" />
<em>Sample input for task 3</em>
</center></p>
<p><center>
<img alt="Close view of a sample input for task 3" src="../../img/task3-input-detail.jpg" />
<em>Close view of a sample input for task 3</em>
</center></p>
<h2 id="ground-truth-and-expected-outputs">Ground truth and Expected outputs</h2>
<p>Expected output for this task is a list of coordinates (in image referential, ie. <code>0,0</code> at top left, x axis pointing to the right and y axis pointing downward).</p>
<p>Coordinates need to be output in a CSV file with the exact same format and naming conventions as the ground truth, except for the <code>GT</code> part of the filename which should be changed into <code>PRED</code>:
if the input image is named <code>train/301-INPUT.jpg</code>, then the output file must be named <code>train/301-OUTPUT-PRED.csv</code>.</p>
<p>The format of the CSV is the same as the one of the ground truth described below.</p>
<p>The CSV should look like:</p>
<pre><code class="language-csv">x,y
2379.0,2338.0
2373.2,4708.2
4744.2,2332.8
4736.5,4724.5
</code></pre>
<p>Each CSV line should indicate an intersection like the one illustrated below.</p>
<p><center>
<img alt="Close view of an intersection point to detection for task 3" src="../../img/task3-output_illustration-detail.jpg" />
<em>Close view of an intersection point to detection for task 3: you can see that many graphical elements can disrupt the detection of such element.</em>
</center></p>
<h2 id="dataset">Dataset</h2>
<p>Content for task 3 is located in the folder named <code>3-locglinesinter</code> in the dataset archive.</p>
<p><strong>WARNING: because the inputs of this task are exactly the same as task 2, we did not duplicate them.</strong>
<em>Please copy or link the <code>2-segmaparea/{train,validation,test}/*-INPUT.jpg</code> files accordingly.</em></p>
<h3 id="file-naming-conventions">File naming conventions</h3>
<p>Train, validation and test folders (if applicable) contain the same kind of files:</p>
<ul>
<li><code>${SUBSET}/${NNN}-INPUT.jpg</code>:<br />
  JPEG RGB image containing the input image to process.
  There are complete map sheet images.
  Those images can be large (10000x10000 pixels).  <blockquote>
<p><em>example:</em><br />
<code>2-segmaparea/train/101-INPUT.jpg</code></p>
</blockquote>
</li>
<li><code>${SUBSET}/${NNN}-OUTPUT-GT.csv</code>:<br />
  CSV file containing a list of intersection coordinates (detailed below).  <blockquote>
<p><em>example:</em><br />
<code>2-segmaparea/train/101-OUTPUT-GT.csv</code></p>
</blockquote>
</li>
</ul>
<h3 id="number-of-elements-per-set">Number of elements per set</h3>
<ul>
<li>train: 26 images</li>
<li>validation: 6 images</li>
<li>test: 97 images</li>
</ul>
<h3 id="csv-file-format">CSV file format</h3>
<ul>
<li>first line: header (always <code>x,y</code>)</li>
<li>other lines: two floats</li>
<li>delimiter: comma (<code>,</code>)</li>
<li>float format: dot (<code>.</code>) as decimal separator, 1 digit after the dot (sub-pixel accuracy)</li>
<li>coordinate system: image: <code>(0,0)</code> is at top left, x axis points to the right and y axis points downward</li>
</ul>
<p><em>CSV example:</em></p>
<pre><code class="language-csv">x,y
2379.0,2338.0
2373.2,4708.2
4744.2,2332.8
4736.5,4724.5
</code></pre>
<h2 id="evaluation">Evaluation</h2>
<p><strong>Evaluation tools and illustrative notebooks provide participants with more details than the summary below.</strong>
<em>Please <a href="../../contact/#subscribe-to-updates">subscribe to updates</a> to be notified when they are available.</em></p>
<p>For each map sheet (ie for each CSV result), we will compare the predicted coordinates with the expected ones.
We will compute for each map sheet the number of correct predictions for each possible distance threshold:</p>
<ul>
<li>a predicted point will be considered as a correct detection if it is the closest predicted point of a ground truth (expected) point and the distance between the expected point and the predicted one is smaller than a given threshold</li>
<li>we will consider all possible thresholds between 0 and 50 pixels, which roughly represents 20 meters on the maps and gives an upper limit over which the registration would be seriously disrupted.</li>
</ul>
<p>For each possible threshold we can compute the number of correct predictions, the number of incorrect ones (the complement of the prediction set) and the number of expected elements.
This allows us to plot a <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>0.5</mn></msub></mrow><annotation encoding="application/x-tex">F_{0.5}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mord mtight">.</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> score vs threshold curve for a range of thresholds.
The <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>β</mi></msub></mrow><annotation encoding="application/x-tex">F_{\beta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05278em;">β</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> score with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">\beta=0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span></span></span></span> <a href="https://en.wikipedia.org/wiki/F-score">weights recall lower than precision</a> because for this task it takes several good detections to correct a wrong one in the final registration.</p>
<p>We will take the area under this "<em><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>0.5</mn></msub></mrow><annotation encoding="application/x-tex">F_{0.5}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mord mtight">.</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> score vs threshold</em>" curve as a performance indicator:
such indicator blends two indicators: point detection and spatial accuracy.</p>
<p>Finally, we will compute the average of the measures for all individual map images to produce a global indicator with a confidence measure.</p>
<p>The resulting measure is a float value between 0 and 1.
A higher value is better.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../downloads/" class="btn btn-neutral float-right" title="Downloads">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../task2/" class="btn btn-neutral" title="Task 2: Segment Map Content Area"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/icdar21-mapseg/icdar21-mapseg.github.io/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../task2/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../downloads/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
